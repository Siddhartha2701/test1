<div class="container ">
    <div class="card rounded-lg w-100 bg-light">
        <div class="card-header d-flex align-items-center pb-0 mb-0">
            <h1 class="display-1 p-0">ChatBot-Reply <span><i class='bx bx-bot'
                        style="color:#000000;font-size: larger;"></i></span></h1>
        </div>
        <div class="card-body pl-4">
            <form [formGroup]="chatbotForm">
                <div class="form-group d-flex align-items-center">
                    <label for="uname" class="pt-2"><strong>User Name<span class="text-danger"
                                style="font-size: medium;">*</span></strong></label>
                    <input type="text" name="uname" id="uname" formControlName="uname"
                        class="form-control form-control-sm w-25 ml-3" [matAutocomplete]="auto"
                        (input)="InputField(chatbotForm.value.uname)" placeholder="Enter User Name">
                    <mat-autocomplete #auto="matAutocomplete">
                        <mat-option *ngFor="let option of options" [value]="option.user_name">
                            {{option.user_name}}
                        </mat-option>
                    </mat-autocomplete>
                </div>

                <div class="row d-flex justify-content-around ">
                    <input type="text" name="key" id="key" formControlName="key"
                        class="form-control form-control-sm col-6" placeholder="Enter Key">
                    <input type="text" name="value" id="value" formControlName="value"
                        class="form-control form-control-sm col-5" placeholder="Enter Value">
                </div>
                <br>
                <div class="d-flex justify-content-end pr-3">
                    <button class="btn btn-sm btn-success" (click)="addItem()">Add Suggestion</button>
                </div>
                <br>
                <div formArrayName="suggestions">
                    <div class="row my-2 d-flex justify-content-around "
                        *ngFor="let item of suggestionsitems.controls;let i=index" [formGroupName]="i">
                        <input type="text" name="stext" id="stext" formControlName="text"
                            class="form-control form-control-sm col-6" placeholder="Enter Suggestion Text">
                        <input type="text" name="spback" id="spback" formControlName="postbackData"
                            class="form-control form-control-sm col-5" placeholder="Enter Suggestion Postback">
                        <span>
                            <button class="btn btn-sm btn-outline-danger pb-0" (click)="removeItem(i)">
                                <span class="material-symbols-outlined p-0 m-0">
                                    delete
                                </span>
                            </button>
                        </span>
                    </div>
                </div>

                <br>
                <br>
                <div class="d-flex justify-content-center">
                    <button class="btn btn-sm btn-info" data-toggle="modal" data-target="#myModal">Preview</button>
                    <button class="btn btn-sm ml-3 btn-primary" (click)="save()">Save</button>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="modal" id="myModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header pb-0">
                <h2 class="modal-title pb-0 display-1">Preview</h2>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="border rounded p-4" style="min-height: 80px; height: auto;">
                    <div class="d-flex justify-content-end px-1">
                        <span class="bg-primary px-2 py-1 text-white"
                            style="border-radius: 30px;">{{chatbotForm.value.key}}</span>
                    </div>
                    <div class="border d-flex bg-light justify-content-start p-1 rounded-lg w-75">
                        {{chatbotForm.value.value}}
                    </div>
                    <br>
                    <div class="d-flex justify-content-end ox ">
                        <span class="px-2 py-1 my-2 mx-1" style="border-radius: 30px; border: 2px solid #0d6efd;"
                            *ngFor="let sugg of chatbotForm.value.suggestions">{{sugg.postbackData}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="alert alert-success alert-dismissible fade show" style="position: absolute; bottom: 2%;right: 3%;" *ngIf="Success">
    <button type="button" class="close pt-2" data-dismiss="alert">&times;</button>
    <strong>{{RetVal}}</strong>
</div>
<div class="alert alert-danger alert-dismissible fade show" style="position: absolute; bottom: 2%;right: 3%;" *ngIf="Failed">
    <button type="button" class="close pt-2" data-dismiss="alert">&times;</button>
    <strong>{{RetVal}}</strong>
</div>